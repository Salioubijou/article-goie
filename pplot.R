library(stats4)
library(splines)
library(VGAM)
# cdf of GIE-W distribution (Weibull)
cdf_GIE_W <- function(par, x){
  lambda <- par[1]
  gamma <- par[2]
  a <- par[3]
  b <- par[4]
  G <-  pweibull(x,a,b)
  cdf <- exp(-lambda*(1-G)*(1+gamma*G)/G)
  return(cdf)
}
# *************************** GOIE-W PP Plot functions *******************
ppGIE_W <- function(y,par) {
  nn<-length(y);
  yvar<-cdf_GIE_W(par,sort(y));
  xvar<-1:nn;
  x<-(xvar-0.5)/nn;
  plot(x,yvar,main="GIE-W P-P Plot",ylab="Expected",xlab="Observed",ylim=c(0,1), pch=16, col="#007FFF");
  curve(1*x,0,1,add=T, col="blue")
}

# ****************** Data set 1*******************************
y2 <- c(70,90,96,97,99,100,103,104,104,105,107,108,108,108,
        109,109,112,112,113,114,114,114,116,119,120,120,120,
        121,121,123,124,124,124,124,124,128,128,129,129,130,
        130,131,131,131,131,131,132,132,132,133,134,134,134,
        134,134,136,136,137,138,138,138,139,139,141,141,142,
        142,142,142,142,142,144,144,145,146,148,148,149,151,
        151,152,155,156,157,157,157,157,158,159,162,163,163,
        164,166,166,168,170,174,196,212)

par(mfrow=c(1,1))
ppGIE_W(y2,res12$mle)
grid()
# *********************** End data set 1***************************
# ************************* Data set 2 ****************************
y3 <- c(0.55, 0.93, 1.25, 1.36, 1.49, 1.52, 1.58, 1.61, 1.64, 1.68, 1.73, 1.81, 2, 0.74, 1.04, 1.27, 1.39,
        1.49, 1.53, 1.59, 1.61, 1.66, 1.68, 1.76, 1.82, 2.01, 0.77, 1.11, 1.28, 1.42, 1.5, 1.54, 1.6, 1.62,
        1.66, 1.69, 1.76, 1.84, 2.24, 0.81, 1.13, 1.29, 1.48, 1.5, 1.55, 1.61, 1.62, 1.66, 1.7, 1.77, 1.84,
        0.84, 1.24, 1.3, 1.48, 1.51, 1.55, 1.61, 1.63, 1.67, 1.7, 1.78, 1.89)

ppGIE_W(y3,res13$mle)
grid()
# ***************************** End data set 2 *******************
# ************************* Data set 3 ****************************
y4 <- c(1.901, 2.132, 2.203, 2.228, 2.257, 2.350, 2.361, 2.396, 2.397, 2.445, 2.454, 2.474, 2.518, 2.522,
        2.525, 2.532, 2.575, 2.614, 2.616, 2.618, 2.624, 2.659, 2.675, 2.738, 2.740, 2.856, 2.917, 2.928,
        2.937, 2.937, 2.977, 2.996, 3.030, 3.125, 3.139, 3.145, 3.220, 3.223, 3.235, 3.243, 3.264, 3.272, 
        3.294, 3.332, 3.346, 3.377, 3.408, 3.435, 3.493, 3.501, 3.537, 3.554, 3.562, 3.628, 3.852, 3.871, 
        3.886, 3.971, 4.024, 4.027, 4.225, 4.395, 5.020)

ppGIE_W(y4,res14$mle)
grid()

# ***************************** End data set 3 *******************